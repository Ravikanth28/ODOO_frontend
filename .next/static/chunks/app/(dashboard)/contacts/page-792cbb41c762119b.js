(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[879],{1184:function(e,t,a){Promise.resolve().then(a.bind(a,5702))},5702:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var l=a(7437),s=a(2265),n=a(9116),r=a(1880),c=a(5838),o=a(6143),i=a(4360),d=a(7202);function u(){let[e,t]=(0,s.useState)([]),[a,u]=(0,s.useState)(!0),[m,x]=(0,s.useState)(!1),[h,p]=(0,s.useState)(null),[b,y]=(0,s.useState)(null),[j,g]=(0,s.useState)(!1),[f,N]=(0,s.useState)(!1),[v,C]=(0,s.useState)(""),[w,k]=(0,s.useState)(""),[S,I]=(0,s.useState)(!0),[L,A]=(0,s.useState)({name:"",displayName:"",contactType:"INDIVIDUAL",email:"",phone:"",mobile:"",website:"",street:"",city:"",state:"",country:"",postalCode:"",companyName:"",taxId:"",isCustomer:!0,isVendor:!1,notes:""}),{showToast:T}=(0,i.p)(),P=(0,n.PR)(),D=(null==P?void 0:P.role)==="ADMIN";(0,s.useEffect)(()=>{E()},[]);let E=async()=>{try{let e={};v&&(e.search=v),w&&(e.contactType=w),S&&(e.portalOnly="true");let a=await n.QZ.getAll(e);t(a)}catch(e){T(e.message||"Failed to load contacts","error")}finally{u(!1)}};(0,s.useEffect)(()=>{let e=setTimeout(()=>{u(!0),E()},300);return()=>clearTimeout(e)},[v,w,S]);let U=e=>{var t,a;p(e),A({name:e.name||"",displayName:e.displayName||"",contactType:e.contactType||"INDIVIDUAL",email:e.email||"",phone:e.phone||"",mobile:e.mobile||"",website:e.website||"",street:e.street||"",city:e.city||"",state:e.state||"",country:e.country||"",postalCode:e.postalCode||"",companyName:e.companyName||"",taxId:e.taxId||"",isCustomer:null===(t=e.isCustomer)||void 0===t||t,isVendor:null!==(a=e.isVendor)&&void 0!==a&&a,notes:e.notes||""}),x(!0)},M=async()=>{if(!L.name){T("Name is required","error");return}g(!0);try{h?(await n.QZ.update(h.id,L),T("Contact updated successfully","success")):(await n.QZ.create(L),T("Contact created successfully","success")),x(!1),E()}catch(e){T(e.message||"Failed to save contact","error")}finally{g(!1)}},V=async()=>{if(b){N(!0);try{await n.QZ.delete(b.id),T("Contact deleted successfully","success"),y(null),E()}catch(e){T(e.message||"Failed to delete contact","error")}finally{N(!1)}}};return a&&0===e.length?(0,l.jsx)(o.Z,{message:"Loading contacts..."}):(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Contacts"}),(0,l.jsxs)("button",{onClick:()=>{p(null),A({name:"",displayName:"",contactType:"INDIVIDUAL",email:"",phone:"",mobile:"",website:"",street:"",city:"",state:"",country:"",postalCode:"",companyName:"",taxId:"",isCustomer:!0,isVendor:!1,notes:""}),x(!0)},className:"btn-primary",children:[(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Contact"]})]}),(0,l.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,l.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:v,onChange:e=>C(e.target.value),className:"form-input max-w-xs"}),(0,l.jsxs)("select",{value:w,onChange:e=>k(e.target.value),className:"form-select w-auto",children:[(0,l.jsx)("option",{value:"",children:"All Types"}),(0,l.jsx)("option",{value:"INDIVIDUAL",children:"Individual"}),(0,l.jsx)("option",{value:"COMPANY",children:"Company"})]}),(0,l.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-700 cursor-pointer",children:[(0,l.jsx)("input",{type:"checkbox",checked:S,onChange:e=>I(e.target.checked),className:"form-checkbox"}),"Portal Users Only"]})]}),(0,l.jsx)("div",{className:"table-container",children:(0,l.jsxs)("table",{className:"data-table",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Name"}),(0,l.jsx)("th",{children:"Type"}),(0,l.jsx)("th",{children:"Email"}),(0,l.jsx)("th",{children:"Phone"}),(0,l.jsx)("th",{children:"City"}),(0,l.jsx)("th",{children:"Customer"}),(0,l.jsx)("th",{children:"Portal User"}),(0,l.jsx)("th",{children:"Actions"})]})}),(0,l.jsxs)("tbody",{children:[e.map(e=>{var t;return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"font-medium text-gray-900",children:e.name}),(0,l.jsx)("td",{children:(0,l.jsx)("span",{className:"badge ".concat("COMPANY"===e.contactType?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:"COMPANY"===e.contactType?"Company":"Individual"})}),(0,l.jsx)("td",{children:e.email||"-"}),(0,l.jsx)("td",{children:e.phone||"-"}),(0,l.jsx)("td",{children:e.city||"-"}),(0,l.jsx)("td",{children:e.isCustomer?(0,l.jsx)("span",{className:"badge-active",children:"Yes"}):(0,l.jsx)("span",{className:"badge-draft",children:"No"})}),(0,l.jsx)("td",{children:(null===(t=e.users)||void 0===t?void 0:t.filter(e=>"PORTAL_USER"===e.role).map(e=>(0,l.jsx)("span",{className:"inline-block mr-1 px-2 py-0.5 bg-purple-50 text-purple-700 rounded text-xs",children:e.name||e.email},e.id)))||"-"}),(0,l.jsx)("td",{children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("button",{onClick:()=>U(e),className:"btn-secondary btn-sm",children:"Edit"}),D&&(0,l.jsx)("button",{onClick:()=>y(e),className:"btn-danger btn-sm",children:"Delete"})]})})]},e.id)}),0===e.length&&(0,l.jsx)("tr",{children:(0,l.jsx)("td",{colSpan:8,className:"text-center py-8 text-gray-500",children:"No contacts found."})})]})]})}),(0,l.jsx)(r.Z,{isOpen:m,onClose:()=>x(!1),title:h?"Edit Contact":"Add Contact",onSubmit:M,submitLabel:h?"Update":"Create",loading:j,size:"lg",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:"Name *"}),(0,l.jsx)("input",{type:"text",required:!0,value:L.name,onChange:e=>A({...L,name:e.target.value}),className:"form-input",placeholder:"Contact name"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:"Type"}),(0,l.jsxs)("select",{value:L.contactType,onChange:e=>A({...L,contactType:e.target.value}),className:"form-select",children:[(0,l.jsx)("option",{value:"INDIVIDUAL",children:"Individual"}),(0,l.jsx)("option",{value:"COMPANY",children:"Company"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:"Email"}),(0,l.jsx)("input",{type:"email",value:L.email,onChange:e=>A({...L,email:e.target.value}),className:"form-input",placeholder:"email@example.com"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:"Phone"}),(0,l.jsx)(d.Z,{value:L.phone,onChange:e=>A({...L,phone:e}),placeholder:"Phone number"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:"Mobile"}),(0,l.jsx)(d.Z,{value:L.mobile,onChange:e=>A({...L,mobile:e}),placeholder:"Mobile number"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:"Website"}),(0,l.jsx)("input",{type:"url",value:L.website,onChange:e=>A({...L,website:e.target.value}),className:"form-input",placeholder:"https://..."})]}),"COMPANY"===L.contactType&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:"Company Name"}),(0,l.jsx)("input",{type:"text",value:L.companyName,onChange:e=>A({...L,companyName:e.target.value}),className:"form-input",placeholder:"Company name"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:"Tax ID (GST/VAT)"}),(0,l.jsx)("input",{type:"text",value:L.taxId,onChange:e=>A({...L,taxId:e.target.value}),className:"form-input",placeholder:"Tax ID"})]})]}),(0,l.jsx)("div",{className:"md:col-span-2",children:(0,l.jsx)("hr",{className:"border-gray-200"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:"Street"}),(0,l.jsx)("input",{type:"text",value:L.street,onChange:e=>A({...L,street:e.target.value}),className:"form-input"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:"City"}),(0,l.jsx)("input",{type:"text",value:L.city,onChange:e=>A({...L,city:e.target.value}),className:"form-input"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:"State"}),(0,l.jsx)("input",{type:"text",value:L.state,onChange:e=>A({...L,state:e.target.value}),className:"form-input"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:"Country"}),(0,l.jsx)("input",{type:"text",value:L.country,onChange:e=>A({...L,country:e.target.value}),className:"form-input"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"form-label",children:"Postal Code"}),(0,l.jsx)("input",{type:"text",value:L.postalCode,onChange:e=>A({...L,postalCode:e.target.value}),className:"form-input"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-6 pt-4",children:[(0,l.jsxs)("label",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"checkbox",checked:L.isCustomer,onChange:e=>A({...L,isCustomer:e.target.checked}),className:"form-checkbox"}),(0,l.jsx)("span",{className:"text-sm text-gray-700",children:"Customer"})]}),(0,l.jsxs)("label",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"checkbox",checked:L.isVendor,onChange:e=>A({...L,isVendor:e.target.checked}),className:"form-checkbox"}),(0,l.jsx)("span",{className:"text-sm text-gray-700",children:"Vendor"})]})]}),(0,l.jsxs)("div",{className:"md:col-span-2",children:[(0,l.jsx)("label",{className:"form-label",children:"Notes"}),(0,l.jsx)("textarea",{value:L.notes,onChange:e=>A({...L,notes:e.target.value}),className:"form-textarea",rows:2})]})]})}),(0,l.jsx)(c.Z,{isOpen:!!b,onConfirm:V,onCancel:()=>y(null),title:"Delete Contact",message:'Are you sure you want to delete "'.concat(null==b?void 0:b.name,'"?'),confirmLabel:"Delete",variant:"danger",loading:f})]})}},5838:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});var l=a(7437);function s(e){let{isOpen:t,onConfirm:a,onCancel:s,title:n,message:r,confirmLabel:c="Confirm",variant:o="danger",loading:i=!1}=e;return t?(0,l.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,l.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:s}),(0,l.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl w-full max-w-sm mx-4 p-6",children:[(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[(0,l.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ".concat("danger"===o?"bg-red-100":"bg-yellow-100"),children:(0,l.jsx)("svg",{className:"w-5 h-5 ".concat("danger"===o?"text-red-600":"text-yellow-600"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:n}),(0,l.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:r})]})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,l.jsx)("button",{onClick:s,className:"btn-secondary",children:"Cancel"}),(0,l.jsx)("button",{onClick:a,disabled:i,className:"danger"===o?"btn-danger":"btn-primary",children:i?"Processing...":c})]})]})]}):null}},7202:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var l=a(7437),s=a(2265);let n=[{code:"+91",country:"IN",label:"India"},{code:"+1",country:"US",label:"United States"},{code:"+44",country:"GB",label:"United Kingdom"},{code:"+61",country:"AU",label:"Australia"},{code:"+81",country:"JP",label:"Japan"},{code:"+49",country:"DE",label:"Germany"},{code:"+33",country:"FR",label:"France"},{code:"+86",country:"CN",label:"China"},{code:"+971",country:"AE",label:"UAE"},{code:"+65",country:"SG",label:"Singapore"},{code:"+55",country:"BR",label:"Brazil"},{code:"+7",country:"RU",label:"Russia"},{code:"+82",country:"KR",label:"South Korea"},{code:"+39",country:"IT",label:"Italy"},{code:"+34",country:"ES",label:"Spain"},{code:"+31",country:"NL",label:"Netherlands"},{code:"+46",country:"SE",label:"Sweden"},{code:"+41",country:"CH",label:"Switzerland"},{code:"+62",country:"ID",label:"Indonesia"},{code:"+60",country:"MY",label:"Malaysia"},{code:"+63",country:"PH",label:"Philippines"},{code:"+66",country:"TH",label:"Thailand"},{code:"+90",country:"TR",label:"Turkey"},{code:"+48",country:"PL",label:"Poland"},{code:"+27",country:"ZA",label:"South Africa"},{code:"+234",country:"NG",label:"Nigeria"},{code:"+254",country:"KE",label:"Kenya"},{code:"+92",country:"PK",label:"Pakistan"},{code:"+880",country:"BD",label:"Bangladesh"},{code:"+94",country:"LK",label:"Sri Lanka"}];function r(e){let{value:t,onChange:a,placeholder:r="Phone number",className:c="",required:o,disabled:i}=e,[d,u]=(0,s.useState)(!1),[m,x]=(0,s.useState)(""),h=(0,s.useRef)(null),p=(()=>{for(let e of n)if(t.startsWith(e.code+" ")||t.startsWith(e.code))return e;return n[0]})(),b=()=>{if(t.startsWith(p.code+" "))return t.slice(p.code.length+1);if(t.startsWith(p.code))return t.slice(p.code.length);for(let e of n)if(t.startsWith(e.code))return t.slice(e.code.length).trimStart();return t},y=e=>{let t=b();a(t?"".concat(e.code," ").concat(t):e.code+" "),u(!1),x("")},j=e=>{a(e?"".concat(p.code," ").concat(e):"")},g=m?n.filter(e=>e.label.toLowerCase().includes(m.toLowerCase())||e.code.includes(m)||e.country.toLowerCase().includes(m.toLowerCase())):n;return(0,s.useEffect)(()=>{let e=e=>{h.current&&!h.current.contains(e.target)&&(u(!1),x(""))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,l.jsxs)("div",{className:"flex ".concat(c),ref:h,children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("button",{type:"button",onClick:()=>!i&&u(!d),disabled:i,className:"flex items-center gap-1 px-3 py-2.5 border border-r-0 border-gray-200 rounded-l-lg bg-gray-50 text-sm text-gray-700 hover:bg-gray-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed h-full",children:[(0,l.jsx)("span",{className:"font-medium",children:p.code}),(0,l.jsx)("svg",{className:"w-3 h-3 text-gray-400 transition-transform ".concat(d?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),d&&(0,l.jsxs)("div",{className:"absolute top-full left-0 mt-1 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50 overflow-hidden",children:[(0,l.jsx)("div",{className:"p-2 border-b border-gray-100",children:(0,l.jsx)("input",{type:"text",placeholder:"Search country...",value:m,onChange:e=>x(e.target.value),className:"w-full px-3 py-1.5 text-sm border border-gray-200 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-transparent outline-none",autoFocus:!0})}),(0,l.jsxs)("div",{className:"max-h-48 overflow-y-auto",children:[g.map(e=>(0,l.jsxs)("button",{type:"button",onClick:()=>y(e),className:"w-full text-left px-3 py-2 text-sm hover:bg-blue-50 transition-colors flex items-center justify-between ".concat(p.code===e.code?"bg-blue-50 text-blue-700":"text-gray-700"),children:[(0,l.jsxs)("span",{children:[e.label," (",e.country,")"]}),(0,l.jsx)("span",{className:"text-gray-500 font-mono text-xs",children:e.code})]},e.code+e.country)),0===g.length&&(0,l.jsx)("div",{className:"px-3 py-2 text-sm text-gray-400",children:"No results"})]})]})]}),(0,l.jsx)("input",{type:"tel",value:b(),onChange:e=>j(e.target.value),placeholder:r,required:o,disabled:i,className:"flex-1 px-4 py-2.5 border border-gray-200 rounded-r-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none disabled:bg-gray-50 disabled:text-gray-500 disabled:cursor-not-allowed"})]})}}},function(e){e.O(0,[424,971,117,744],function(){return e(e.s=1184)}),_N_E=e.O()}]);