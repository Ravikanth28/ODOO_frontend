(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[297],{7424:function(e,t,l){Promise.resolve().then(l.bind(l,3550))},3550:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return u}});var a=l(7437),n=l(2265),s=l(9116),r=l(1880),o=l(5838),c=l(6143),d=l(4360),i=l(7202);function u(){let[e,t]=(0,n.useState)([]),[l,u]=(0,n.useState)(!0),[h,m]=(0,n.useState)(!1),[x,b]=(0,n.useState)(null),[f,y]=(0,n.useState)(!1),[p,g]=(0,n.useState)(!1),[j,N]=(0,n.useState)(null),[v,w]=(0,n.useState)({name:"",email:"",password:"",phone:""}),{showToast:C}=(0,d.p)(),S=(0,s.PR)(),k=(null==S?void 0:S.role)==="ADMIN";(0,n.useEffect)(()=>{L()},[]);let L=async()=>{try{let e=await s.h3.getAll();t(e)}catch(e){C(e.message||"Failed to load users","error")}finally{u(!1)}},A=async()=>{if(!v.name||!v.email||!v.password){C("Please fill in required fields","error");return}y(!0);try{let e={name:v.name,email:v.email,password:v.password};v.phone&&(e.phone=v.phone),await s.h3.createInternal(e),C("User created successfully","success"),m(!1),L()}catch(e){C(e.message||"Failed to create user","error")}finally{y(!1)}},E=async(e,t)=>{N(e);try{await s.h3.changeRole(e,t),C("Role updated successfully","success"),L()}catch(e){C(e.message||"Failed to change role","error")}finally{N(null)}},R=async()=>{if(x){g(!0);try{await s.h3.delete(x.id),C("User deleted successfully","success"),b(null),L()}catch(e){C(e.message||"Failed to delete user","error")}finally{g(!1)}}},U=e=>(0,a.jsx)("span",{className:{ADMIN:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-700",INTERNAL_USER:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-700",PORTAL_USER:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-700"}[e]||"badge-draft",children:{ADMIN:"Admin",INTERNAL_USER:"Internal User",PORTAL_USER:"Portal User"}[e]||e});return l?(0,a.jsx)(c.Z,{message:"Loading users..."}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Users"}),k&&(0,a.jsxs)("button",{onClick:()=>{w({name:"",email:"",password:"",phone:""}),m(!0)},className:"btn-primary",children:[(0,a.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add User"]})]}),(0,a.jsx)("div",{className:"table-container",children:(0,a.jsxs)("table",{className:"data-table",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{children:"Name"}),(0,a.jsx)("th",{children:"Email"}),(0,a.jsx)("th",{children:"Role"}),(0,a.jsx)("th",{children:"Phone"}),(0,a.jsx)("th",{children:"Created"}),k&&(0,a.jsx)("th",{children:"Actions"})]})}),(0,a.jsxs)("tbody",{children:[e.map(e=>(0,a.jsxs)("tr",{children:[(0,a.jsx)("td",{className:"font-medium text-gray-900",children:e.name}),(0,a.jsx)("td",{children:e.email}),(0,a.jsx)("td",{children:U(e.role)}),(0,a.jsx)("td",{children:e.phone||"-"}),(0,a.jsx)("td",{children:new Date(e.createdAt).toLocaleDateString()}),k&&(0,a.jsx)("td",{children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("select",{value:e.role,onChange:t=>E(e.id,t.target.value),disabled:j===e.id||e.id===(null==S?void 0:S.id),className:"form-select text-xs py-1 px-2 w-auto",children:[(0,a.jsx)("option",{value:"ADMIN",children:"Admin"}),(0,a.jsx)("option",{value:"INTERNAL_USER",children:"Internal User"}),(0,a.jsx)("option",{value:"PORTAL_USER",children:"Portal User"})]}),e.id!==(null==S?void 0:S.id)&&(0,a.jsx)("button",{onClick:()=>b(e),className:"btn-danger btn-sm",children:"Delete"})]})})]},e.id)),0===e.length&&(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:k?6:5,className:"text-center py-8 text-gray-500",children:"No users found."})})]})]})}),(0,a.jsx)(r.Z,{isOpen:h,onClose:()=>m(!1),title:"Add User",onSubmit:A,submitLabel:"Create",loading:f,children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"Name"}),(0,a.jsx)("input",{type:"text",required:!0,value:v.name,onChange:e=>w({...v,name:e.target.value}),className:"form-input",placeholder:"Full name"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"Email"}),(0,a.jsx)("input",{type:"email",required:!0,value:v.email,onChange:e=>w({...v,email:e.target.value}),className:"form-input",placeholder:"user@example.com"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"Password"}),(0,a.jsx)("input",{type:"password",required:!0,value:v.password,onChange:e=>w({...v,password:e.target.value}),className:"form-input",placeholder:"Minimum 6 characters"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"form-label",children:"Phone"}),(0,a.jsx)(i.Z,{value:v.phone,onChange:e=>w({...v,phone:e}),placeholder:"Phone number (optional)"})]})]})}),(0,a.jsx)(o.Z,{isOpen:!!x,onConfirm:R,onCancel:()=>b(null),title:"Delete User",message:'Are you sure you want to delete "'.concat(null==x?void 0:x.name,'"? This action cannot be undone.'),confirmLabel:"Delete",variant:"danger",loading:p})]})}},5838:function(e,t,l){"use strict";l.d(t,{Z:function(){return n}});var a=l(7437);function n(e){let{isOpen:t,onConfirm:l,onCancel:n,title:s,message:r,confirmLabel:o="Confirm",variant:c="danger",loading:d=!1}=e;return t?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,a.jsx)("div",{className:"fixed inset-0 bg-black/40",onClick:n}),(0,a.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl w-full max-w-sm mx-4 p-6",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ".concat("danger"===c?"bg-red-100":"bg-yellow-100"),children:(0,a.jsx)("svg",{className:"w-5 h-5 ".concat("danger"===c?"text-red-600":"text-yellow-600"),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:s}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:r})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,a.jsx)("button",{onClick:n,className:"btn-secondary",children:"Cancel"}),(0,a.jsx)("button",{onClick:l,disabled:d,className:"danger"===c?"btn-danger":"btn-primary",children:d?"Processing...":o})]})]})]}):null}},7202:function(e,t,l){"use strict";l.d(t,{Z:function(){return r}});var a=l(7437),n=l(2265);let s=[{code:"+91",country:"IN",label:"India"},{code:"+1",country:"US",label:"United States"},{code:"+44",country:"GB",label:"United Kingdom"},{code:"+61",country:"AU",label:"Australia"},{code:"+81",country:"JP",label:"Japan"},{code:"+49",country:"DE",label:"Germany"},{code:"+33",country:"FR",label:"France"},{code:"+86",country:"CN",label:"China"},{code:"+971",country:"AE",label:"UAE"},{code:"+65",country:"SG",label:"Singapore"},{code:"+55",country:"BR",label:"Brazil"},{code:"+7",country:"RU",label:"Russia"},{code:"+82",country:"KR",label:"South Korea"},{code:"+39",country:"IT",label:"Italy"},{code:"+34",country:"ES",label:"Spain"},{code:"+31",country:"NL",label:"Netherlands"},{code:"+46",country:"SE",label:"Sweden"},{code:"+41",country:"CH",label:"Switzerland"},{code:"+62",country:"ID",label:"Indonesia"},{code:"+60",country:"MY",label:"Malaysia"},{code:"+63",country:"PH",label:"Philippines"},{code:"+66",country:"TH",label:"Thailand"},{code:"+90",country:"TR",label:"Turkey"},{code:"+48",country:"PL",label:"Poland"},{code:"+27",country:"ZA",label:"South Africa"},{code:"+234",country:"NG",label:"Nigeria"},{code:"+254",country:"KE",label:"Kenya"},{code:"+92",country:"PK",label:"Pakistan"},{code:"+880",country:"BD",label:"Bangladesh"},{code:"+94",country:"LK",label:"Sri Lanka"}];function r(e){let{value:t,onChange:l,placeholder:r="Phone number",className:o="",required:c,disabled:d}=e,[i,u]=(0,n.useState)(!1),[h,m]=(0,n.useState)(""),x=(0,n.useRef)(null),b=(()=>{for(let e of s)if(t.startsWith(e.code+" ")||t.startsWith(e.code))return e;return s[0]})(),f=()=>{if(t.startsWith(b.code+" "))return t.slice(b.code.length+1);if(t.startsWith(b.code))return t.slice(b.code.length);for(let e of s)if(t.startsWith(e.code))return t.slice(e.code.length).trimStart();return t},y=e=>{let t=f();l(t?"".concat(e.code," ").concat(t):e.code+" "),u(!1),m("")},p=e=>{l(e?"".concat(b.code," ").concat(e):"")},g=h?s.filter(e=>e.label.toLowerCase().includes(h.toLowerCase())||e.code.includes(h)||e.country.toLowerCase().includes(h.toLowerCase())):s;return(0,n.useEffect)(()=>{let e=e=>{x.current&&!x.current.contains(e.target)&&(u(!1),m(""))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),(0,a.jsxs)("div",{className:"flex ".concat(o),ref:x,children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("button",{type:"button",onClick:()=>!d&&u(!i),disabled:d,className:"flex items-center gap-1 px-3 py-2.5 border border-r-0 border-gray-200 rounded-l-lg bg-gray-50 text-sm text-gray-700 hover:bg-gray-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed h-full",children:[(0,a.jsx)("span",{className:"font-medium",children:b.code}),(0,a.jsx)("svg",{className:"w-3 h-3 text-gray-400 transition-transform ".concat(i?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),i&&(0,a.jsxs)("div",{className:"absolute top-full left-0 mt-1 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50 overflow-hidden",children:[(0,a.jsx)("div",{className:"p-2 border-b border-gray-100",children:(0,a.jsx)("input",{type:"text",placeholder:"Search country...",value:h,onChange:e=>m(e.target.value),className:"w-full px-3 py-1.5 text-sm border border-gray-200 rounded-md focus:ring-1 focus:ring-blue-500 focus:border-transparent outline-none",autoFocus:!0})}),(0,a.jsxs)("div",{className:"max-h-48 overflow-y-auto",children:[g.map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>y(e),className:"w-full text-left px-3 py-2 text-sm hover:bg-blue-50 transition-colors flex items-center justify-between ".concat(b.code===e.code?"bg-blue-50 text-blue-700":"text-gray-700"),children:[(0,a.jsxs)("span",{children:[e.label," (",e.country,")"]}),(0,a.jsx)("span",{className:"text-gray-500 font-mono text-xs",children:e.code})]},e.code+e.country)),0===g.length&&(0,a.jsx)("div",{className:"px-3 py-2 text-sm text-gray-400",children:"No results"})]})]})]}),(0,a.jsx)("input",{type:"tel",value:f(),onChange:e=>p(e.target.value),placeholder:r,required:c,disabled:d,className:"flex-1 px-4 py-2.5 border border-gray-200 rounded-r-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none disabled:bg-gray-50 disabled:text-gray-500 disabled:cursor-not-allowed"})]})}}},function(e){e.O(0,[424,971,117,744],function(){return e(e.s=7424)}),_N_E=e.O()}]);