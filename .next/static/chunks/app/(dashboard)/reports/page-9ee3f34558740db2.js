(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[960],{5864:function(e,t,r){Promise.resolve().then(r.bind(r,6964))},6964:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return i}});var n=r(7437),o=r(2265),a=r(9116),s=r(6143),c=r(4360);function i(){let[e,t]=(0,o.useState)("overview"),[r,i]=(0,o.useState)(null),[d,l]=(0,o.useState)(!0),{showToast:u}=(0,c.p)();(0,o.useEffect)(()=>{m(e)},[e]);let m=async e=>{l(!0);try{let t;switch(e){case"overview":t=await a.ax.getDashboard();break;case"subscriptions":t=await a.ax.getSubscriptions();break;case"revenue":t=await a.ax.getRevenue();break;case"payments":t=await a.ax.getPayments()}i(t)}catch(e){u(e.message||"Failed to load report data","error")}finally{l(!1)}};return(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("div",{className:"flex items-center justify-between",children:(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Reports"})}),(0,n.jsx)("div",{className:"border-b border-gray-200",children:(0,n.jsx)("nav",{className:"flex gap-0 -mb-px",children:[{key:"overview",label:"Overview"},{key:"subscriptions",label:"Subscriptions"},{key:"revenue",label:"Revenue"},{key:"payments",label:"Payments"}].map(r=>(0,n.jsx)("button",{onClick:()=>t(r.key),className:"px-4 py-3 text-sm font-medium border-b-2 transition-colors ".concat(e===r.key?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:r.label},r.key))})}),d?(0,n.jsx)(s.Z,{message:"Loading report..."}):({overview:()=>{if(!r)return null;let e=[{label:"Active Subscriptions",value:r.activeSubscriptions||0,border:"border-l-blue-500"},{label:"Total Revenue",value:"₹".concat((r.totalRevenue||0).toLocaleString()),border:"border-l-emerald-500"},{label:"Pending Revenue",value:"₹".concat((r.pendingRevenue||0).toLocaleString()),border:"border-l-amber-500"},{label:"Overdue Invoices",value:r.overdueInvoices||0,border:"border-l-red-500"},{label:"Total Payments",value:r.totalPayments||0,border:"border-l-indigo-500"}];return(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map((e,t)=>(0,n.jsxs)("div",{className:"card border-l-4 ".concat(e.border," p-5"),children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-500",children:e.label}),(0,n.jsx)("p",{className:"mt-1 text-2xl font-bold text-gray-900",children:e.value})]},t))})},subscriptions:()=>{if(!r)return null;let e=Array.isArray(r)?r:r.byStatus||[];return(0,n.jsx)("div",{className:"table-container",children:(0,n.jsxs)("table",{className:"data-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Status"}),(0,n.jsx)("th",{children:"Count"}),(0,n.jsx)("th",{children:"Percentage"})]})}),(0,n.jsxs)("tbody",{children:[e.map((t,r)=>{let o=e.reduce((e,t)=>e+(Number(t.count)||Number(t._count)||0),0),a=Number(t.count)||Number(t._count)||0,s=o>0?(a/o*100).toFixed(1):"0";return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"font-medium text-gray-900",children:t.status||t.name||"-"}),(0,n.jsx)("td",{children:a}),(0,n.jsxs)("td",{children:[s,"%"]})]},r)}),0===e.length&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:3,className:"text-center py-8 text-gray-500",children:"No subscription data available."})})]})]})})},revenue:()=>{if(!r)return null;let e=Array.isArray(r)?r:r.monthly||[];return(0,n.jsx)("div",{className:"table-container",children:(0,n.jsxs)("table",{className:"data-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Period"}),(0,n.jsx)("th",{children:"Revenue"}),(0,n.jsx)("th",{children:"Invoices"})]})}),(0,n.jsxs)("tbody",{children:[e.map((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"font-medium text-gray-900",children:e.month||e.period||e.name||"-"}),(0,n.jsxs)("td",{className:"text-emerald-600 font-medium",children:["₹",Number(e.revenue||e.total||e.amount||0).toLocaleString("en-IN")]}),(0,n.jsx)("td",{children:e.invoiceCount||e.count||"-"})]},t)),0===e.length&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:3,className:"text-center py-8 text-gray-500",children:"No revenue data available."})})]})]})})},payments:()=>{if(!r)return null;let e=Array.isArray(r)?r:r.byMethod||[];return(0,n.jsx)("div",{className:"table-container",children:(0,n.jsxs)("table",{className:"data-table",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"Payment Method"}),(0,n.jsx)("th",{children:"Count"}),(0,n.jsx)("th",{children:"Total Amount"})]})}),(0,n.jsxs)("tbody",{children:[e.map((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"font-medium text-gray-900",children:(e.paymentMethod||e.method||e.name||"-").replace(/_/g," ")}),(0,n.jsx)("td",{children:e.count||e._count||0}),(0,n.jsxs)("td",{className:"text-emerald-600 font-medium",children:["₹",Number(e.total||e.amount||e.totalAmount||0).toLocaleString("en-IN")]})]},t)),0===e.length&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:3,className:"text-center py-8 text-gray-500",children:"No payment data available."})})]})]})})}})[e]()]})}},6143:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(7437);function o(e){let{message:t="Loading..."}=e;return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,n.jsx)("div",{className:"w-8 h-8 border-3 border-primary/30 border-t-primary rounded-full animate-spin"}),(0,n.jsx)("p",{className:"mt-3 text-sm text-gray-500",children:t})]})}},4360:function(e,t,r){"use strict";r.d(t,{ToastProvider:function(){return i},p:function(){return s}});var n=r(7437),o=r(2265);let a=(0,o.createContext)({showToast:()=>{}}),s=()=>(0,o.useContext)(a),c=0;function i(e){let{children:t}=e,[r,s]=(0,o.useState)([]),i=(0,o.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",r=++c;s(n=>[...n,{id:r,message:e,type:t}]),setTimeout(()=>{s(e=>e.filter(e=>e.id!==r))},4e3)},[]),d=e=>{s(t=>t.filter(t=>t.id!==e))},l={success:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",error:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",warning:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z",info:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},u={success:"bg-emerald-50 border-emerald-200 text-emerald-800",error:"bg-red-50 border-red-200 text-red-800",warning:"bg-yellow-50 border-yellow-200 text-yellow-800",info:"bg-blue-50 border-blue-200 text-blue-800"},m={success:"text-emerald-500",error:"text-red-500",warning:"text-yellow-500",info:"text-blue-500"};return(0,n.jsxs)(a.Provider,{value:{showToast:i},children:[t,(0,n.jsx)("div",{className:"fixed top-4 right-4 z-[100] flex flex-col gap-2 max-w-sm",children:r.map(e=>(0,n.jsxs)("div",{className:"".concat(u[e.type]," border rounded-lg p-3 shadow-lg flex items-start gap-3 animate-[slideIn_0.3s_ease-out]"),children:[(0,n.jsx)("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5 ".concat(m[e.type]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:l[e.type]})}),(0,n.jsx)("p",{className:"text-sm flex-1",children:e.message}),(0,n.jsx)("button",{onClick:()=>d(e.id),className:"text-gray-400 hover:text-gray-600",children:(0,n.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},e.id))})]})}},9116:function(e,t,r){"use strict";r.d(t,{Co:function(){return u},F3:function(){return l},JG:function(){return j},PR:function(){return s},QB:function(){return g},QZ:function(){return v},TL:function(){return y},TV:function(){return m},_g:function(){return S},av:function(){return c},ax:function(){return x},g6:function(){return h},gy:function(){return a},h3:function(){return f},iV:function(){return b},kv:function(){return d},o4:function(){return o},rW:function(){return p},tQ:function(){return N},xf:function(){return O}});let n=()=>localStorage.getItem("token"),o=e=>{localStorage.setItem("token",e)},a=()=>{localStorage.removeItem("token"),localStorage.removeItem("user")},s=()=>{{let e=localStorage.getItem("user");return e?JSON.parse(e):null}},c=e=>{localStorage.setItem("user",JSON.stringify(e))},i=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n(),o={"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)},...t.headers},a=await fetch("".concat("http://localhost:5001/api").concat(e),{...t,headers:o});if(!a.ok)throw Error((await a.json().catch(()=>({error:"Request failed"}))).error||"Request failed");return a.json()},d={signup:e=>i("/auth/signup",{method:"POST",body:JSON.stringify(e)}),login:e=>i("/auth/login",{method:"POST",body:JSON.stringify(e)}),requestPasswordReset:e=>i("/auth/reset-password-request",{method:"POST",body:JSON.stringify({email:e})}),resetPassword:(e,t)=>i("/auth/reset-password",{method:"POST",body:JSON.stringify({token:e,newPassword:t})}),getCurrentUser:()=>i("/auth/me")},l={getAll:()=>i("/products"),getOne:e=>i("/products/".concat(e)),create:e=>i("/products",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>i("/products/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>i("/products/".concat(e),{method:"DELETE"}),addVariant:(e,t)=>i("/products/".concat(e,"/variants"),{method:"POST",body:JSON.stringify(t)}),getVariants:e=>i("/products/".concat(e,"/variants")),updateVariant:(e,t,r)=>i("/products/".concat(e,"/variants/").concat(t),{method:"PUT",body:JSON.stringify(r)}),deleteVariant:(e,t)=>i("/products/".concat(e,"/variants/").concat(t),{method:"DELETE"}),getAttributeLines:e=>i("/products/".concat(e,"/attributes")),addAttributeLine:(e,t)=>i("/products/".concat(e,"/attributes"),{method:"POST",body:JSON.stringify(t)}),deleteAttributeLine:(e,t)=>i("/products/".concat(e,"/attributes/").concat(t),{method:"DELETE"})},u={getAll:()=>i("/plans"),getOne:e=>i("/plans/".concat(e)),create:e=>i("/plans",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>i("/plans/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>i("/plans/".concat(e),{method:"DELETE"})},m={getAll:()=>i("/subscriptions"),getOne:e=>i("/subscriptions/".concat(e)),create:e=>i("/subscriptions",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>i("/subscriptions/".concat(e),{method:"PUT",body:JSON.stringify(t)}),updateStatus:(e,t)=>i("/subscriptions/".concat(e,"/status"),{method:"PUT",body:JSON.stringify({status:t})}),addLine:(e,t)=>i("/subscriptions/".concat(e,"/lines"),{method:"POST",body:JSON.stringify(t)}),delete:e=>i("/subscriptions/".concat(e),{method:"DELETE"}),deleteLine:(e,t)=>i("/subscriptions/".concat(e,"/lines/").concat(t),{method:"DELETE"}),renew:e=>i("/subscriptions/".concat(e,"/renew"),{method:"POST"}),upsell:(e,t)=>i("/subscriptions/".concat(e,"/upsell"),{method:"POST",body:JSON.stringify({additionalLines:t})}),getHistory:e=>i("/subscriptions/".concat(e,"/history"))},h={getAll:e=>{let t=e?"?"+new URLSearchParams(Object.entries(e).filter(e=>{let[,t]=e;return t})).toString():"";return i("/invoices".concat(t))},getOne:e=>i("/invoices/".concat(e)),generate:(e,t)=>i("/invoices/generate/".concat(e),{method:"POST",body:t?JSON.stringify(t):void 0}),update:(e,t)=>i("/invoices/".concat(e),{method:"PUT",body:JSON.stringify(t)}),confirm:e=>i("/invoices/".concat(e,"/confirm"),{method:"PUT"}),cancel:e=>i("/invoices/".concat(e,"/cancel"),{method:"PUT"}),addLine:(e,t)=>i("/invoices/".concat(e,"/lines"),{method:"POST",body:JSON.stringify(t)}),deleteLine:(e,t)=>i("/invoices/".concat(e,"/lines/").concat(t),{method:"DELETE"})},b={getAll:()=>i("/payments"),getOne:e=>i("/payments/".concat(e)),create:e=>i("/payments",{method:"POST",body:JSON.stringify(e)})},g={getAll:()=>i("/taxes"),getOne:e=>i("/taxes/".concat(e)),create:e=>i("/taxes",{method:"POST",body:JSON.stringify(e)}),suggest:e=>i("/taxes/suggest",{method:"POST",body:JSON.stringify(e)}),calculate:e=>i("/taxes/calculate",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>i("/taxes/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>i("/taxes/".concat(e),{method:"DELETE"})},y={getAll:()=>i("/discounts"),getOne:e=>i("/discounts/".concat(e)),create:e=>i("/discounts",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>i("/discounts/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>i("/discounts/".concat(e),{method:"DELETE"})},p={getAll:()=>i("/quotations"),getOne:e=>i("/quotations/".concat(e)),create:e=>i("/quotations",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>i("/quotations/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>i("/quotations/".concat(e),{method:"DELETE"}),addLine:(e,t)=>i("/quotations/".concat(e,"/lines"),{method:"POST",body:JSON.stringify(t)}),updateLine:(e,t,r)=>i("/quotations/".concat(e,"/lines/").concat(t),{method:"PUT",body:JSON.stringify(r)}),deleteLine:(e,t)=>i("/quotations/".concat(e,"/lines/").concat(t),{method:"DELETE"}),createSubscription:(e,t)=>i("/quotations/".concat(e,"/create-subscription"),{method:"POST",body:JSON.stringify(t)})},f={getAll:e=>{let t=e?"?"+new URLSearchParams(Object.entries(e).filter(e=>{let[,t]=e;return t})).toString():"";return i("/users".concat(t))},getOne:e=>i("/users/".concat(e)),createInternal:e=>i("/users/internal",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>i("/users/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>i("/users/".concat(e),{method:"DELETE"}),changeRole:(e,t)=>i("/users/".concat(e,"/role"),{method:"PUT",body:JSON.stringify({role:t})})},x={getDashboard:()=>i("/reports/dashboard"),getSubscriptions:()=>i("/reports/subscriptions"),getRevenue:()=>i("/reports/revenue"),getPayments:()=>i("/reports/payments"),getOverdueInvoices:()=>i("/reports/overdue-invoices")},S={createOrder:e=>i("/razorpay/create-order",{method:"POST",body:JSON.stringify({subscriptionId:e})}),verifyPayment:e=>i("/razorpay/verify-payment",{method:"POST",body:JSON.stringify(e)})},v={getAll:e=>{let t=e?"?"+new URLSearchParams(Object.entries(e).filter(e=>{let[,t]=e;return void 0!==t})).toString():"";return i("/contacts".concat(t))},getOne:e=>i("/contacts/".concat(e)),create:e=>i("/contacts",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>i("/contacts/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>i("/contacts/".concat(e),{method:"DELETE"}),getChildren:e=>i("/contacts/".concat(e,"/children"))},O={getAll:()=>i("/attributes"),getOne:e=>i("/attributes/".concat(e)),create:e=>i("/attributes",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>i("/attributes/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>i("/attributes/".concat(e),{method:"DELETE"}),addValue:(e,t)=>i("/attributes/".concat(e,"/values"),{method:"POST",body:JSON.stringify(t)}),updateValue:(e,t,r)=>i("/attributes/".concat(e,"/values/").concat(t),{method:"PUT",body:JSON.stringify(r)}),deleteValue:(e,t)=>i("/attributes/".concat(e,"/values/").concat(t),{method:"DELETE"})},N={generateInvoice:e=>i("/pdf/invoice/".concat(e),{method:"POST"}),generateQuotation:e=>i("/pdf/quotation/".concat(e),{method:"POST"})},j={getDashboard:()=>i("/portal/dashboard"),getCatalog:e=>{let t=e?"?"+new URLSearchParams(Object.entries(e).filter(e=>{let[,t]=e;return t})).toString():"";return i("/portal/catalog".concat(t))},getSubscriptions:()=>i("/portal/subscriptions"),getSubscription:e=>i("/portal/subscriptions/".concat(e)),getInvoices:()=>i("/portal/invoices"),getInvoice:e=>i("/portal/invoices/".concat(e)),getPayments:()=>i("/portal/payments"),getProfile:()=>i("/portal/profile"),updateProfile:e=>i("/portal/profile",{method:"PUT",body:JSON.stringify(e)}),subscribe:e=>i("/portal/subscribe",{method:"POST",body:JSON.stringify({planId:e})})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=5864)}),_N_E=e.O()}]);