(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[903],{5987:function(e,t,n){Promise.resolve().then(n.bind(n,9710))},9710:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var s=n(7437),o=n(2265),r=n(9376),a=n(9116),i=n(6143),c=n(3745);function d(){var e,t;let[n,d]=(0,o.useState)(null),[l,u]=(0,o.useState)(!0),m=(0,r.useRouter)();(0,o.useEffect)(()=>{g()},[]);let g=async()=>{try{let e=await a.ax.getDashboard();d(e)}catch(e){console.error("Failed to load metrics:",e)}finally{u(!1)}};if(l)return(0,s.jsx)(i.Z,{message:"Loading dashboard..."});let h=[{title:"Active Subscriptions",value:(null==n?void 0:n.activeSubscriptions)||0,borderColor:"border-l-blue-500",iconBg:"bg-blue-50 text-blue-600",icon:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})},{title:"Total Revenue",value:"₹".concat(((null==n?void 0:n.totalRevenue)||0).toLocaleString("en-IN")),borderColor:"border-l-emerald-500",iconBg:"bg-emerald-50 text-emerald-600",icon:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})},{title:"Pending Revenue",value:"₹".concat(((null==n?void 0:n.pendingRevenue)||0).toLocaleString("en-IN")),borderColor:"border-l-amber-500",iconBg:"bg-amber-50 text-amber-600",icon:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})},{title:"Overdue Invoices",value:(null==n?void 0:n.overdueInvoices)||0,borderColor:"border-l-red-500",iconBg:"bg-red-50 text-red-600",icon:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})},{title:"Total Subscriptions",value:(null==n?void 0:n.totalSubscriptions)||0,borderColor:"border-l-indigo-500",iconBg:"bg-indigo-50 text-indigo-600",icon:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}],p={DRAFT:"bg-gray-100 text-gray-700",QUOTATION:"bg-blue-100 text-blue-700",CONFIRMED:"bg-yellow-100 text-yellow-700",ACTIVE:"bg-emerald-100 text-emerald-700",CLOSED:"bg-red-100 text-red-700"},b=(null==n?void 0:n.subscriptionsByStatus)||[];return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"flex items-center justify-between",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"})}),(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:h.map((e,t)=>(0,s.jsx)("div",{className:"card border-l-4 ".concat(e.borderColor," p-5"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:e.title}),(0,s.jsx)("p",{className:"mt-1 text-2xl font-bold text-gray-900",children:e.value})]}),(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center ".concat(e.iconBg),children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.icon})})]})},t))}),(0,s.jsxs)("div",{className:"card p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,s.jsxs)("button",{onClick:()=>m.push("/subscriptions/new"),className:"btn-primary btn-lg justify-center",children:[(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"New Subscription"]}),(0,s.jsxs)("button",{onClick:()=>m.push("/invoices"),className:"btn-secondary btn-lg justify-center",children:[(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"View Invoices"]}),(0,s.jsxs)("button",{onClick:()=>m.push("/payments"),className:"btn-secondary btn-lg justify-center",children:[(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),"Record Payment"]})]})]}),b.length>0&&(0,s.jsxs)("div",{className:"card p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Subscription Status Breakdown"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-3",children:b.map(e=>{var t;return(0,s.jsxs)("div",{className:"px-4 py-2.5 rounded-lg ".concat(p[e.status]||"bg-gray-100 text-gray-700"),children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:e.status}),(0,s.jsx)("span",{className:"ml-2 text-lg font-bold",children:(null===(t=e._count)||void 0===t?void 0:t.id)||0})]},e.status)})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"card p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Subscriptions"}),(0,s.jsx)("button",{onClick:()=>m.push("/subscriptions"),className:"text-sm text-primary hover:underline",children:"View all"})]}),(0,s.jsx)("div",{className:"space-y-3",children:(null==n?void 0:null===(e=n.recentSubscriptions)||void 0===e?void 0:e.length)>0?n.recentSubscriptions.map(e=>{var t,n,o;return(0,s.jsxs)("div",{onClick:()=>m.push("/subscriptions/".concat(e.id)),className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.subscriptionNumber}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:[(null===(t=e.customer)||void 0===t?void 0:t.name)||"-"," \xb7 ",(null===(n=e.plan)||void 0===n?void 0:n.name)||"-"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-3",children:[(null===(o=e.plan)||void 0===o?void 0:o.price)&&(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["₹",Number(e.plan.price).toLocaleString("en-IN")]}),(0,s.jsx)(c.Z,{status:e.status})]})]},e.id)}):(0,s.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No subscriptions yet."})})]}),(0,s.jsxs)("div",{className:"card p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Invoices"}),(0,s.jsx)("button",{onClick:()=>m.push("/invoices"),className:"text-sm text-primary hover:underline",children:"View all"})]}),(0,s.jsx)("div",{className:"space-y-3",children:(null==n?void 0:null===(t=n.recentInvoices)||void 0===t?void 0:t.length)>0?n.recentInvoices.map(e=>{var t;return(0,s.jsxs)("div",{onClick:()=>m.push("/invoices/".concat(e.id)),className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 cursor-pointer transition-colors",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.invoiceNumber}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:[(null===(t=e.customer)||void 0===t?void 0:t.name)||"-"," \xb7 ",new Date(e.invoiceDate).toLocaleDateString()]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 ml-3",children:[(0,s.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["₹",Number(e.totalAmount).toLocaleString("en-IN")]}),(0,s.jsx)(c.Z,{status:e.status})]})]},e.id)}):(0,s.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No invoices yet."})})]})]}),(null==n?void 0:n.monthlyRevenue)&&(0,s.jsxs)("div",{className:"card p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Monthly Revenue"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"p-4 bg-emerald-50 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm text-emerald-600 font-medium",children:"This Month"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-emerald-700 mt-1",children:["₹",(n.monthlyRevenue.currentMonth||0).toLocaleString("en-IN")]})]}),(0,s.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,s.jsx)("p",{className:"text-sm text-gray-500 font-medium",children:"Last Month"}),(0,s.jsxs)("p",{className:"text-2xl font-bold text-gray-700 mt-1",children:["₹",(n.monthlyRevenue.lastMonth||0).toLocaleString("en-IN")]})]})]})]})]})}},6143:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var s=n(7437);function o(e){let{message:t="Loading..."}=e;return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-3 border-primary/30 border-t-primary rounded-full animate-spin"}),(0,s.jsx)("p",{className:"mt-3 text-sm text-gray-500",children:t})]})}},3745:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var s=n(7437);let o={DRAFT:"badge-draft",QUOTATION:"badge-quotation",CONFIRMED:"badge-confirmed",ACTIVE:"badge-active",PAID:"badge-paid",CLOSED:"badge-closed",CANCELLED:"badge-cancelled"};function r(e){let{status:t}=e,n=o[t]||"badge-draft";return(0,s.jsx)("span",{className:n,children:t.replace("_"," ")})}},9116:function(e,t,n){"use strict";n.d(t,{Co:function(){return u},F3:function(){return l},JG:function(){return j},PR:function(){return a},QB:function(){return p},QZ:function(){return N},TL:function(){return b},TV:function(){return m},_g:function(){return v},av:function(){return i},ax:function(){return f},g6:function(){return g},gy:function(){return r},h3:function(){return x},iV:function(){return h},kv:function(){return d},o4:function(){return o},rW:function(){return y},tQ:function(){return O},xf:function(){return S}});let s=()=>localStorage.getItem("token"),o=e=>{localStorage.setItem("token",e)},r=()=>{localStorage.removeItem("token"),localStorage.removeItem("user")},a=()=>{{let e=localStorage.getItem("user");return e?JSON.parse(e):null}},i=e=>{localStorage.setItem("user",JSON.stringify(e))},c=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=s(),o={"Content-Type":"application/json",...n&&{Authorization:"Bearer ".concat(n)},...t.headers},r=await fetch("".concat("http://localhost:5001/api").concat(e),{...t,headers:o});if(!r.ok)throw Error((await r.json().catch(()=>({error:"Request failed"}))).error||"Request failed");return r.json()},d={signup:e=>c("/auth/signup",{method:"POST",body:JSON.stringify(e)}),login:e=>c("/auth/login",{method:"POST",body:JSON.stringify(e)}),requestPasswordReset:e=>c("/auth/reset-password-request",{method:"POST",body:JSON.stringify({email:e})}),resetPassword:(e,t)=>c("/auth/reset-password",{method:"POST",body:JSON.stringify({token:e,newPassword:t})}),getCurrentUser:()=>c("/auth/me")},l={getAll:()=>c("/products"),getOne:e=>c("/products/".concat(e)),create:e=>c("/products",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>c("/products/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>c("/products/".concat(e),{method:"DELETE"}),addVariant:(e,t)=>c("/products/".concat(e,"/variants"),{method:"POST",body:JSON.stringify(t)}),getVariants:e=>c("/products/".concat(e,"/variants")),updateVariant:(e,t,n)=>c("/products/".concat(e,"/variants/").concat(t),{method:"PUT",body:JSON.stringify(n)}),deleteVariant:(e,t)=>c("/products/".concat(e,"/variants/").concat(t),{method:"DELETE"}),getAttributeLines:e=>c("/products/".concat(e,"/attributes")),addAttributeLine:(e,t)=>c("/products/".concat(e,"/attributes"),{method:"POST",body:JSON.stringify(t)}),deleteAttributeLine:(e,t)=>c("/products/".concat(e,"/attributes/").concat(t),{method:"DELETE"})},u={getAll:()=>c("/plans"),getOne:e=>c("/plans/".concat(e)),create:e=>c("/plans",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>c("/plans/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>c("/plans/".concat(e),{method:"DELETE"})},m={getAll:()=>c("/subscriptions"),getOne:e=>c("/subscriptions/".concat(e)),create:e=>c("/subscriptions",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>c("/subscriptions/".concat(e),{method:"PUT",body:JSON.stringify(t)}),updateStatus:(e,t)=>c("/subscriptions/".concat(e,"/status"),{method:"PUT",body:JSON.stringify({status:t})}),addLine:(e,t)=>c("/subscriptions/".concat(e,"/lines"),{method:"POST",body:JSON.stringify(t)}),delete:e=>c("/subscriptions/".concat(e),{method:"DELETE"}),deleteLine:(e,t)=>c("/subscriptions/".concat(e,"/lines/").concat(t),{method:"DELETE"}),renew:e=>c("/subscriptions/".concat(e,"/renew"),{method:"POST"}),upsell:(e,t)=>c("/subscriptions/".concat(e,"/upsell"),{method:"POST",body:JSON.stringify({additionalLines:t})}),getHistory:e=>c("/subscriptions/".concat(e,"/history"))},g={getAll:e=>{let t=e?"?"+new URLSearchParams(Object.entries(e).filter(e=>{let[,t]=e;return t})).toString():"";return c("/invoices".concat(t))},getOne:e=>c("/invoices/".concat(e)),generate:(e,t)=>c("/invoices/generate/".concat(e),{method:"POST",body:t?JSON.stringify(t):void 0}),update:(e,t)=>c("/invoices/".concat(e),{method:"PUT",body:JSON.stringify(t)}),confirm:e=>c("/invoices/".concat(e,"/confirm"),{method:"PUT"}),cancel:e=>c("/invoices/".concat(e,"/cancel"),{method:"PUT"}),addLine:(e,t)=>c("/invoices/".concat(e,"/lines"),{method:"POST",body:JSON.stringify(t)}),deleteLine:(e,t)=>c("/invoices/".concat(e,"/lines/").concat(t),{method:"DELETE"})},h={getAll:()=>c("/payments"),getOne:e=>c("/payments/".concat(e)),create:e=>c("/payments",{method:"POST",body:JSON.stringify(e)})},p={getAll:()=>c("/taxes"),getOne:e=>c("/taxes/".concat(e)),create:e=>c("/taxes",{method:"POST",body:JSON.stringify(e)}),suggest:e=>c("/taxes/suggest",{method:"POST",body:JSON.stringify(e)}),calculate:e=>c("/taxes/calculate",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>c("/taxes/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>c("/taxes/".concat(e),{method:"DELETE"})},b={getAll:()=>c("/discounts"),getOne:e=>c("/discounts/".concat(e)),create:e=>c("/discounts",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>c("/discounts/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>c("/discounts/".concat(e),{method:"DELETE"})},y={getAll:()=>c("/quotations"),getOne:e=>c("/quotations/".concat(e)),create:e=>c("/quotations",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>c("/quotations/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>c("/quotations/".concat(e),{method:"DELETE"}),addLine:(e,t)=>c("/quotations/".concat(e,"/lines"),{method:"POST",body:JSON.stringify(t)}),updateLine:(e,t,n)=>c("/quotations/".concat(e,"/lines/").concat(t),{method:"PUT",body:JSON.stringify(n)}),deleteLine:(e,t)=>c("/quotations/".concat(e,"/lines/").concat(t),{method:"DELETE"}),createSubscription:(e,t)=>c("/quotations/".concat(e,"/create-subscription"),{method:"POST",body:JSON.stringify(t)})},x={getAll:e=>{let t=e?"?"+new URLSearchParams(Object.entries(e).filter(e=>{let[,t]=e;return t})).toString():"";return c("/users".concat(t))},getOne:e=>c("/users/".concat(e)),createInternal:e=>c("/users/internal",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>c("/users/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>c("/users/".concat(e),{method:"DELETE"}),changeRole:(e,t)=>c("/users/".concat(e,"/role"),{method:"PUT",body:JSON.stringify({role:t})})},f={getDashboard:()=>c("/reports/dashboard"),getSubscriptions:()=>c("/reports/subscriptions"),getRevenue:()=>c("/reports/revenue"),getPayments:()=>c("/reports/payments"),getOverdueInvoices:()=>c("/reports/overdue-invoices")},v={createOrder:e=>c("/razorpay/create-order",{method:"POST",body:JSON.stringify({subscriptionId:e})}),verifyPayment:e=>c("/razorpay/verify-payment",{method:"POST",body:JSON.stringify(e)})},N={getAll:e=>{let t=e?"?"+new URLSearchParams(Object.entries(e).filter(e=>{let[,t]=e;return void 0!==t})).toString():"";return c("/contacts".concat(t))},getOne:e=>c("/contacts/".concat(e)),create:e=>c("/contacts",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>c("/contacts/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>c("/contacts/".concat(e),{method:"DELETE"}),getChildren:e=>c("/contacts/".concat(e,"/children"))},S={getAll:()=>c("/attributes"),getOne:e=>c("/attributes/".concat(e)),create:e=>c("/attributes",{method:"POST",body:JSON.stringify(e)}),update:(e,t)=>c("/attributes/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:e=>c("/attributes/".concat(e),{method:"DELETE"}),addValue:(e,t)=>c("/attributes/".concat(e,"/values"),{method:"POST",body:JSON.stringify(t)}),updateValue:(e,t,n)=>c("/attributes/".concat(e,"/values/").concat(t),{method:"PUT",body:JSON.stringify(n)}),deleteValue:(e,t)=>c("/attributes/".concat(e,"/values/").concat(t),{method:"DELETE"})},O={generateInvoice:e=>c("/pdf/invoice/".concat(e),{method:"POST"}),generateQuotation:e=>c("/pdf/quotation/".concat(e),{method:"POST"})},j={getDashboard:()=>c("/portal/dashboard"),getCatalog:e=>{let t=e?"?"+new URLSearchParams(Object.entries(e).filter(e=>{let[,t]=e;return t})).toString():"";return c("/portal/catalog".concat(t))},getSubscriptions:()=>c("/portal/subscriptions"),getSubscription:e=>c("/portal/subscriptions/".concat(e)),getInvoices:()=>c("/portal/invoices"),getInvoice:e=>c("/portal/invoices/".concat(e)),getPayments:()=>c("/portal/payments"),getProfile:()=>c("/portal/profile"),updateProfile:e=>c("/portal/profile",{method:"PUT",body:JSON.stringify(e)}),subscribe:e=>c("/portal/subscribe",{method:"POST",body:JSON.stringify({planId:e})})}},9376:function(e,t,n){"use strict";var s=n(5475);n.o(s,"useParams")&&n.d(t,{useParams:function(){return s.useParams}}),n.o(s,"usePathname")&&n.d(t,{usePathname:function(){return s.usePathname}}),n.o(s,"useRouter")&&n.d(t,{useRouter:function(){return s.useRouter}}),n.o(s,"useSearchParams")&&n.d(t,{useSearchParams:function(){return s.useSearchParams}})}},function(e){e.O(0,[971,117,744],function(){return e(e.s=5987)}),_N_E=e.O()}]);