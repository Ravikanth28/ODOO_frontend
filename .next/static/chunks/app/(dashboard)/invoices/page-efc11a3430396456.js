(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[972],{468:function(t,e,n){Promise.resolve().then(n.bind(n,7820))},7820:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return l}});var o=n(7437),s=n(2265),r=n(9376),a=n(9116),i=n(3745),c=n(6143),d=n(4360);function l(){let[t,e]=(0,s.useState)([]),[n,l]=(0,s.useState)(!0),[u,m]=(0,s.useState)(""),[h,g]=(0,s.useState)(""),f=(0,r.useRouter)(),{showToast:p}=(0,d.p)();(0,s.useEffect)(()=>{x()},[]);let x=async()=>{try{let t=await a.g6.getAll();e(t)}catch(t){p(t.message||"Failed to load invoices","error")}finally{l(!1)}},b=t.filter(t=>{var e,n;let o=!u||t.invoiceNumber.toLowerCase().includes(u.toLowerCase())||(null===(n=t.customer)||void 0===n?void 0:null===(e=n.name)||void 0===e?void 0:e.toLowerCase().includes(u.toLowerCase())),s=!h||t.status===h;return o&&s}),y=t=>"CANCELLED"!==t.status&&"PAID"!==t.status&&!!t.dueDate&&new Date(t.dueDate)<new Date&&t.paidAmount<t.totalAmount,S={total:t.length,draft:t.filter(t=>"DRAFT"===t.status).length,confirmed:t.filter(t=>"CONFIRMED"===t.status).length,paid:t.filter(t=>"PAID"===t.status).length,overdue:t.filter(t=>y(t)).length,totalAmount:t.reduce((t,e)=>t+Number(e.totalAmount||0),0),totalPaid:t.reduce((t,e)=>t+Number(e.paidAmount||0),0)};return n?(0,o.jsx)(c.Z,{message:"Loading invoices..."}):(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsx)("div",{className:"flex items-center justify-between",children:(0,o.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Invoices"})}),(0,o.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,o.jsxs)("div",{className:"card p-4",children:[(0,o.jsx)("p",{className:"text-sm text-gray-500",children:"Total Invoices"}),(0,o.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:S.total})]}),(0,o.jsxs)("div",{className:"card p-4",children:[(0,o.jsx)("p",{className:"text-sm text-gray-500",children:"Total Amount"}),(0,o.jsxs)("p",{className:"text-2xl font-bold text-gray-900",children:["₹",S.totalAmount.toFixed(2)]})]}),(0,o.jsxs)("div",{className:"card p-4",children:[(0,o.jsx)("p",{className:"text-sm text-gray-500",children:"Total Collected"}),(0,o.jsxs)("p",{className:"text-2xl font-bold text-emerald-600",children:["₹",S.totalPaid.toFixed(2)]})]}),(0,o.jsxs)("div",{className:"card p-4",children:[(0,o.jsx)("p",{className:"text-sm text-gray-500",children:"Overdue"}),(0,o.jsx)("p",{className:"text-2xl font-bold ".concat(S.overdue>0?"text-red-600":"text-gray-900"),children:S.overdue})]})]}),(0,o.jsxs)("div",{className:"flex items-center gap-3",children:[(0,o.jsx)("input",{type:"text",placeholder:"Search by invoice # or customer...",value:u,onChange:t=>m(t.target.value),className:"form-input flex-1"}),(0,o.jsxs)("select",{value:h,onChange:t=>g(t.target.value),className:"form-select w-40",children:[(0,o.jsx)("option",{value:"",children:"All Status"}),(0,o.jsx)("option",{value:"DRAFT",children:"Draft"}),(0,o.jsx)("option",{value:"CONFIRMED",children:"Confirmed"}),(0,o.jsx)("option",{value:"PAID",children:"Paid"}),(0,o.jsx)("option",{value:"CANCELLED",children:"Cancelled"})]})]}),(0,o.jsx)("div",{className:"table-container",children:(0,o.jsxs)("table",{className:"data-table",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"Invoice #"}),(0,o.jsx)("th",{children:"Customer"}),(0,o.jsx)("th",{children:"Subscription"}),(0,o.jsx)("th",{children:"Date"}),(0,o.jsx)("th",{children:"Due Date"}),(0,o.jsx)("th",{children:"Total"}),(0,o.jsx)("th",{children:"Paid"}),(0,o.jsx)("th",{children:"Balance"}),(0,o.jsx)("th",{children:"Status"}),(0,o.jsx)("th",{children:"Actions"})]})}),(0,o.jsxs)("tbody",{children:[b.map(t=>{var e,n;let s=Number(t.totalAmount)-Number(t.paidAmount),r=y(t);return(0,o.jsxs)("tr",{className:r?"bg-red-50":"",children:[(0,o.jsx)("td",{className:"font-medium text-gray-900 font-mono text-sm",children:t.invoiceNumber}),(0,o.jsx)("td",{children:(null===(e=t.customer)||void 0===e?void 0:e.name)||"-"}),(0,o.jsx)("td",{className:"font-mono text-xs text-gray-500",children:(null===(n=t.subscription)||void 0===n?void 0:n.subscriptionNumber)||"-"}),(0,o.jsx)("td",{children:new Date(t.invoiceDate).toLocaleDateString()}),(0,o.jsxs)("td",{children:[(0,o.jsx)("span",{className:r?"text-red-600 font-medium":"",children:t.dueDate?new Date(t.dueDate).toLocaleDateString():"-"}),r&&(0,o.jsx)("span",{className:"ml-1 text-xs text-red-500 font-medium",children:"OVERDUE"})]}),(0,o.jsxs)("td",{className:"font-medium",children:["₹",Number(t.totalAmount).toFixed(2)]}),(0,o.jsxs)("td",{className:"text-emerald-600 font-medium",children:["₹",Number(t.paidAmount).toFixed(2)]}),(0,o.jsxs)("td",{className:"font-medium ".concat(s>0?"text-red-600":"text-emerald-600"),children:["₹",s.toFixed(2)]}),(0,o.jsx)("td",{children:(0,o.jsx)(i.Z,{status:t.status})}),(0,o.jsx)("td",{children:(0,o.jsx)("button",{onClick:()=>f.push("/invoices/".concat(t.id)),className:"btn-secondary btn-sm",children:"View"})})]},t.id)}),0===b.length&&(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:10,className:"text-center py-8 text-gray-500",children:"No invoices found."})})]})]})})]})}},6143:function(t,e,n){"use strict";n.d(e,{Z:function(){return s}});var o=n(7437);function s(t){let{message:e="Loading..."}=t;return(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,o.jsx)("div",{className:"w-8 h-8 border-3 border-primary/30 border-t-primary rounded-full animate-spin"}),(0,o.jsx)("p",{className:"mt-3 text-sm text-gray-500",children:e})]})}},3745:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var o=n(7437);let s={DRAFT:"badge-draft",QUOTATION:"badge-quotation",CONFIRMED:"badge-confirmed",ACTIVE:"badge-active",PAID:"badge-paid",CLOSED:"badge-closed",CANCELLED:"badge-cancelled"};function r(t){let{status:e}=t,n=s[e]||"badge-draft";return(0,o.jsx)("span",{className:n,children:e.replace("_"," ")})}},4360:function(t,e,n){"use strict";n.d(e,{ToastProvider:function(){return c},p:function(){return a}});var o=n(7437),s=n(2265);let r=(0,s.createContext)({showToast:()=>{}}),a=()=>(0,s.useContext)(r),i=0;function c(t){let{children:e}=t,[n,a]=(0,s.useState)([]),c=(0,s.useCallback)(function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=++i;a(o=>[...o,{id:n,message:t,type:e}]),setTimeout(()=>{a(t=>t.filter(t=>t.id!==n))},4e3)},[]),d=t=>{a(e=>e.filter(e=>e.id!==t))},l={success:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z",error:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z",warning:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z",info:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},u={success:"bg-emerald-50 border-emerald-200 text-emerald-800",error:"bg-red-50 border-red-200 text-red-800",warning:"bg-yellow-50 border-yellow-200 text-yellow-800",info:"bg-blue-50 border-blue-200 text-blue-800"},m={success:"text-emerald-500",error:"text-red-500",warning:"text-yellow-500",info:"text-blue-500"};return(0,o.jsxs)(r.Provider,{value:{showToast:c},children:[e,(0,o.jsx)("div",{className:"fixed top-4 right-4 z-[100] flex flex-col gap-2 max-w-sm",children:n.map(t=>(0,o.jsxs)("div",{className:"".concat(u[t.type]," border rounded-lg p-3 shadow-lg flex items-start gap-3 animate-[slideIn_0.3s_ease-out]"),children:[(0,o.jsx)("svg",{className:"w-5 h-5 flex-shrink-0 mt-0.5 ".concat(m[t.type]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:l[t.type]})}),(0,o.jsx)("p",{className:"text-sm flex-1",children:t.message}),(0,o.jsx)("button",{onClick:()=>d(t.id),className:"text-gray-400 hover:text-gray-600",children:(0,o.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,o.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},t.id))})]})}},9116:function(t,e,n){"use strict";n.d(e,{Co:function(){return u},F3:function(){return l},JG:function(){return j},PR:function(){return a},QB:function(){return f},QZ:function(){return N},TL:function(){return p},TV:function(){return m},_g:function(){return S},av:function(){return i},ax:function(){return y},g6:function(){return h},gy:function(){return r},h3:function(){return b},iV:function(){return g},kv:function(){return d},o4:function(){return s},rW:function(){return x},tQ:function(){return v},xf:function(){return O}});let o=()=>localStorage.getItem("token"),s=t=>{localStorage.setItem("token",t)},r=()=>{localStorage.removeItem("token"),localStorage.removeItem("user")},a=()=>{{let t=localStorage.getItem("user");return t?JSON.parse(t):null}},i=t=>{localStorage.setItem("user",JSON.stringify(t))},c=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=o(),s={"Content-Type":"application/json",...n&&{Authorization:"Bearer ".concat(n)},...e.headers},r=await fetch("".concat("http://localhost:5001/api").concat(t),{...e,headers:s});if(!r.ok)throw Error((await r.json().catch(()=>({error:"Request failed"}))).error||"Request failed");return r.json()},d={signup:t=>c("/auth/signup",{method:"POST",body:JSON.stringify(t)}),login:t=>c("/auth/login",{method:"POST",body:JSON.stringify(t)}),requestPasswordReset:t=>c("/auth/reset-password-request",{method:"POST",body:JSON.stringify({email:t})}),resetPassword:(t,e)=>c("/auth/reset-password",{method:"POST",body:JSON.stringify({token:t,newPassword:e})}),getCurrentUser:()=>c("/auth/me")},l={getAll:()=>c("/products"),getOne:t=>c("/products/".concat(t)),create:t=>c("/products",{method:"POST",body:JSON.stringify(t)}),update:(t,e)=>c("/products/".concat(t),{method:"PUT",body:JSON.stringify(e)}),delete:t=>c("/products/".concat(t),{method:"DELETE"}),addVariant:(t,e)=>c("/products/".concat(t,"/variants"),{method:"POST",body:JSON.stringify(e)}),getVariants:t=>c("/products/".concat(t,"/variants")),updateVariant:(t,e,n)=>c("/products/".concat(t,"/variants/").concat(e),{method:"PUT",body:JSON.stringify(n)}),deleteVariant:(t,e)=>c("/products/".concat(t,"/variants/").concat(e),{method:"DELETE"}),getAttributeLines:t=>c("/products/".concat(t,"/attributes")),addAttributeLine:(t,e)=>c("/products/".concat(t,"/attributes"),{method:"POST",body:JSON.stringify(e)}),deleteAttributeLine:(t,e)=>c("/products/".concat(t,"/attributes/").concat(e),{method:"DELETE"})},u={getAll:()=>c("/plans"),getOne:t=>c("/plans/".concat(t)),create:t=>c("/plans",{method:"POST",body:JSON.stringify(t)}),update:(t,e)=>c("/plans/".concat(t),{method:"PUT",body:JSON.stringify(e)}),delete:t=>c("/plans/".concat(t),{method:"DELETE"})},m={getAll:()=>c("/subscriptions"),getOne:t=>c("/subscriptions/".concat(t)),create:t=>c("/subscriptions",{method:"POST",body:JSON.stringify(t)}),update:(t,e)=>c("/subscriptions/".concat(t),{method:"PUT",body:JSON.stringify(e)}),updateStatus:(t,e)=>c("/subscriptions/".concat(t,"/status"),{method:"PUT",body:JSON.stringify({status:e})}),addLine:(t,e)=>c("/subscriptions/".concat(t,"/lines"),{method:"POST",body:JSON.stringify(e)}),delete:t=>c("/subscriptions/".concat(t),{method:"DELETE"}),deleteLine:(t,e)=>c("/subscriptions/".concat(t,"/lines/").concat(e),{method:"DELETE"}),renew:t=>c("/subscriptions/".concat(t,"/renew"),{method:"POST"}),upsell:(t,e)=>c("/subscriptions/".concat(t,"/upsell"),{method:"POST",body:JSON.stringify({additionalLines:e})}),getHistory:t=>c("/subscriptions/".concat(t,"/history"))},h={getAll:t=>{let e=t?"?"+new URLSearchParams(Object.entries(t).filter(t=>{let[,e]=t;return e})).toString():"";return c("/invoices".concat(e))},getOne:t=>c("/invoices/".concat(t)),generate:(t,e)=>c("/invoices/generate/".concat(t),{method:"POST",body:e?JSON.stringify(e):void 0}),update:(t,e)=>c("/invoices/".concat(t),{method:"PUT",body:JSON.stringify(e)}),confirm:t=>c("/invoices/".concat(t,"/confirm"),{method:"PUT"}),cancel:t=>c("/invoices/".concat(t,"/cancel"),{method:"PUT"}),addLine:(t,e)=>c("/invoices/".concat(t,"/lines"),{method:"POST",body:JSON.stringify(e)}),deleteLine:(t,e)=>c("/invoices/".concat(t,"/lines/").concat(e),{method:"DELETE"})},g={getAll:()=>c("/payments"),getOne:t=>c("/payments/".concat(t)),create:t=>c("/payments",{method:"POST",body:JSON.stringify(t)})},f={getAll:()=>c("/taxes"),getOne:t=>c("/taxes/".concat(t)),create:t=>c("/taxes",{method:"POST",body:JSON.stringify(t)}),suggest:t=>c("/taxes/suggest",{method:"POST",body:JSON.stringify(t)}),calculate:t=>c("/taxes/calculate",{method:"POST",body:JSON.stringify(t)}),update:(t,e)=>c("/taxes/".concat(t),{method:"PUT",body:JSON.stringify(e)}),delete:t=>c("/taxes/".concat(t),{method:"DELETE"})},p={getAll:()=>c("/discounts"),getOne:t=>c("/discounts/".concat(t)),create:t=>c("/discounts",{method:"POST",body:JSON.stringify(t)}),update:(t,e)=>c("/discounts/".concat(t),{method:"PUT",body:JSON.stringify(e)}),delete:t=>c("/discounts/".concat(t),{method:"DELETE"})},x={getAll:()=>c("/quotations"),getOne:t=>c("/quotations/".concat(t)),create:t=>c("/quotations",{method:"POST",body:JSON.stringify(t)}),update:(t,e)=>c("/quotations/".concat(t),{method:"PUT",body:JSON.stringify(e)}),delete:t=>c("/quotations/".concat(t),{method:"DELETE"}),addLine:(t,e)=>c("/quotations/".concat(t,"/lines"),{method:"POST",body:JSON.stringify(e)}),updateLine:(t,e,n)=>c("/quotations/".concat(t,"/lines/").concat(e),{method:"PUT",body:JSON.stringify(n)}),deleteLine:(t,e)=>c("/quotations/".concat(t,"/lines/").concat(e),{method:"DELETE"}),createSubscription:(t,e)=>c("/quotations/".concat(t,"/create-subscription"),{method:"POST",body:JSON.stringify(e)})},b={getAll:t=>{let e=t?"?"+new URLSearchParams(Object.entries(t).filter(t=>{let[,e]=t;return e})).toString():"";return c("/users".concat(e))},getOne:t=>c("/users/".concat(t)),createInternal:t=>c("/users/internal",{method:"POST",body:JSON.stringify(t)}),update:(t,e)=>c("/users/".concat(t),{method:"PUT",body:JSON.stringify(e)}),delete:t=>c("/users/".concat(t),{method:"DELETE"}),changeRole:(t,e)=>c("/users/".concat(t,"/role"),{method:"PUT",body:JSON.stringify({role:e})})},y={getDashboard:()=>c("/reports/dashboard"),getSubscriptions:()=>c("/reports/subscriptions"),getRevenue:()=>c("/reports/revenue"),getPayments:()=>c("/reports/payments"),getOverdueInvoices:()=>c("/reports/overdue-invoices")},S={createOrder:t=>c("/razorpay/create-order",{method:"POST",body:JSON.stringify({subscriptionId:t})}),verifyPayment:t=>c("/razorpay/verify-payment",{method:"POST",body:JSON.stringify(t)})},N={getAll:t=>{let e=t?"?"+new URLSearchParams(Object.entries(t).filter(t=>{let[,e]=t;return void 0!==e})).toString():"";return c("/contacts".concat(e))},getOne:t=>c("/contacts/".concat(t)),create:t=>c("/contacts",{method:"POST",body:JSON.stringify(t)}),update:(t,e)=>c("/contacts/".concat(t),{method:"PUT",body:JSON.stringify(e)}),delete:t=>c("/contacts/".concat(t),{method:"DELETE"}),getChildren:t=>c("/contacts/".concat(t,"/children"))},O={getAll:()=>c("/attributes"),getOne:t=>c("/attributes/".concat(t)),create:t=>c("/attributes",{method:"POST",body:JSON.stringify(t)}),update:(t,e)=>c("/attributes/".concat(t),{method:"PUT",body:JSON.stringify(e)}),delete:t=>c("/attributes/".concat(t),{method:"DELETE"}),addValue:(t,e)=>c("/attributes/".concat(t,"/values"),{method:"POST",body:JSON.stringify(e)}),updateValue:(t,e,n)=>c("/attributes/".concat(t,"/values/").concat(e),{method:"PUT",body:JSON.stringify(n)}),deleteValue:(t,e)=>c("/attributes/".concat(t,"/values/").concat(e),{method:"DELETE"})},v={generateInvoice:t=>c("/pdf/invoice/".concat(t),{method:"POST"}),generateQuotation:t=>c("/pdf/quotation/".concat(t),{method:"POST"})},j={getDashboard:()=>c("/portal/dashboard"),getCatalog:t=>{let e=t?"?"+new URLSearchParams(Object.entries(t).filter(t=>{let[,e]=t;return e})).toString():"";return c("/portal/catalog".concat(e))},getSubscriptions:()=>c("/portal/subscriptions"),getSubscription:t=>c("/portal/subscriptions/".concat(t)),getInvoices:()=>c("/portal/invoices"),getInvoice:t=>c("/portal/invoices/".concat(t)),getPayments:()=>c("/portal/payments"),getProfile:()=>c("/portal/profile"),updateProfile:t=>c("/portal/profile",{method:"PUT",body:JSON.stringify(t)}),subscribe:t=>c("/portal/subscribe",{method:"POST",body:JSON.stringify({planId:t})})}},9376:function(t,e,n){"use strict";var o=n(5475);n.o(o,"useParams")&&n.d(e,{useParams:function(){return o.useParams}}),n.o(o,"usePathname")&&n.d(e,{usePathname:function(){return o.usePathname}}),n.o(o,"useRouter")&&n.d(e,{useRouter:function(){return o.useRouter}}),n.o(o,"useSearchParams")&&n.d(e,{useSearchParams:function(){return o.useSearchParams}})}},function(t){t.O(0,[971,117,744],function(){return t(t.s=468)}),_N_E=t.O()}]);