(()=>{var e={};e.id=115,e.ids=[115],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3491:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>p,pages:()=>c,routeModule:()=>u,tree:()=>d}),a(4701),a(8032),a(5866),a(6835);var t=a(3191),r=a(8716),n=a(7922),l=a.n(n),i=a(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);a.d(s,o);let d=["",{children:["(dashboard)",{children:["subscriptions",{children:["new",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,4701)),"E:\\frontend\\app\\(dashboard)\\subscriptions\\new\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,8032)),"E:\\frontend\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,6835)),"E:\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],c=["E:\\frontend\\app\\(dashboard)\\subscriptions\\new\\page.tsx"],p="/(dashboard)/subscriptions/new/page",m={require:a,loadChunk:()=>Promise.resolve()},u=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(dashboard)/subscriptions/new/page",pathname:"/subscriptions/new",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1547:(e,s,a)=>{Promise.resolve().then(a.bind(a,981))},981:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>d});var t=a(326),r=a(7577),n=a(5047),l=a(6824),i=a(2980),o=a(2948);function d(){let[e,s]=(0,r.useState)([]),[a,d]=(0,r.useState)([]),[c,p]=(0,r.useState)(!0),[m,u]=(0,r.useState)(!1),[x,b]=(0,r.useState)(null),[h,g]=(0,r.useState)(!1),[j,f]=(0,r.useState)({customerId:"",planId:"",startDate:new Date().toISOString().split("T")[0],expirationDate:"",paymentTerms:""}),y=(0,n.useRouter)(),{showToast:v}=(0,o.p)(),N=x?.role==="PORTAL_USER",P=async e=>{if(e.preventDefault(),!N&&!j.customerId){v("Please select a customer","error");return}if(!j.planId){v("Please select a plan","error");return}u(!0);try{let e={planId:j.planId,startDate:j.startDate};N||(e.customerId=j.customerId),j.expirationDate&&(e.expirationDate=j.expirationDate),j.paymentTerms&&(e.paymentTerms=j.paymentTerms),await l.TV.create(e),v("Subscription created successfully","success"),y.push("/subscriptions")}catch(e){v(e.message||"Failed to create subscription","error")}finally{u(!1)}};return c?t.jsx(i.Z,{message:"Loading form data..."}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("button",{onClick:()=>y.back(),className:"btn-secondary btn-sm",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"New Subscription"})]}),t.jsx("div",{className:"card p-6",children:(0,t.jsxs)("form",{onSubmit:P,className:"space-y-5",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[N?(0,t.jsxs)("div",{children:[t.jsx("label",{className:"form-label",children:"Customer"}),t.jsx("input",{type:"text",value:x?.name||"",className:"form-input bg-gray-50",disabled:!0}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subscription will be created for your account"})]}):(0,t.jsxs)("div",{children:[t.jsx("label",{className:"form-label",children:"Customer"}),(0,t.jsxs)("select",{value:j.customerId,onChange:e=>f({...j,customerId:e.target.value}),className:"form-select",required:!0,children:[t.jsx("option",{value:"",children:"Select a customer..."}),e.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," (",e.email,")"]},e.id))]})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"form-label",children:"Plan"}),(0,t.jsxs)("select",{value:j.planId,onChange:e=>f({...j,planId:e.target.value}),className:"form-select",required:!0,children:[t.jsx("option",{value:"",children:"Select a plan..."}),a.map(e=>(0,t.jsxs)("option",{value:e.id,children:[e.name," - ","₹",Number(e.price).toFixed(2)," / ",e.billingPeriod.toLowerCase()]},e.id))]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{children:[t.jsx("label",{className:"form-label",children:"Start Date"}),t.jsx("input",{type:"date",value:j.startDate,onChange:e=>f({...j,startDate:e.target.value}),className:"form-input",required:!0})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"form-label",children:"Expiration Date"}),t.jsx("input",{type:"date",value:j.expirationDate,onChange:e=>f({...j,expirationDate:e.target.value}),className:"form-input"})]}),(0,t.jsxs)("div",{children:[t.jsx("label",{className:"form-label",children:"Payment Terms"}),t.jsx("input",{type:"text",value:j.paymentTerms,onChange:e=>f({...j,paymentTerms:e.target.value}),className:"form-input",placeholder:"e.g., Net 30, Due on Receipt"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 pt-4 border-t border-gray-200",children:[t.jsx("button",{type:"submit",disabled:m,className:"btn-primary",children:m?"Creating...":"Create Subscription"}),t.jsx("button",{type:"button",onClick:()=>y.back(),className:"btn-secondary",children:"Cancel"}),(0,t.jsxs)("button",{type:"button",onClick:()=>g(!h),className:"btn-secondary ml-auto flex items-center gap-2",children:[t.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),h?"Hide Plans":"Show Plans"]})]})]})}),h&&(0,t.jsxs)("div",{className:"card p-6",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Available Plans"}),0===a.length?t.jsx("p",{className:"text-gray-500 text-sm",children:"No plans available."}):t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(e=>(0,t.jsxs)("div",{onClick:()=>{f({...j,planId:e.id}),g(!1),v(`Selected plan: ${e.name}`,"success")},className:`border rounded-xl p-4 cursor-pointer transition-all hover:shadow-md ${j.planId===e.id?"border-primary bg-primary/5 ring-1 ring-primary":"border-gray-200 hover:border-primary/30"}`,children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:e.name}),j.planId===e.id&&t.jsx("span",{className:"text-xs bg-primary text-white px-2 py-0.5 rounded-full",children:"Selected"})]}),e.description&&t.jsx("p",{className:"text-sm text-gray-500 mb-3",children:e.description}),(0,t.jsxs)("div",{className:"flex items-baseline gap-1 mb-3",children:[(0,t.jsxs)("span",{className:"text-xl font-bold text-gray-900",children:["₹",Number(e.price).toLocaleString("en-IN")]}),(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["/ ",e.billingPeriod.toLowerCase()]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-1.5 text-xs",children:[t.jsx("span",{className:"px-2 py-0.5 bg-blue-50 text-blue-700 rounded-full",children:e.billingPeriod}),e.renewable&&t.jsx("span",{className:"px-2 py-0.5 bg-green-50 text-green-700 rounded-full",children:"Renewable"}),e.pausable&&t.jsx("span",{className:"px-2 py-0.5 bg-amber-50 text-amber-700 rounded-full",children:"Pausable"}),e.closable&&t.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full",children:"Closable"})]})]},e.id))})]})]})}},4701:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>t});let t=(0,a(8570).createProxy)(String.raw`E:\frontend\app\(dashboard)\subscriptions\new\page.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),t=s.X(0,[697,496,315,78],()=>a(3491));module.exports=t})();