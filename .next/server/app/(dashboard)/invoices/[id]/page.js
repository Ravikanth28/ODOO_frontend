(()=>{var e={};e.id=949,e.ids=[949],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6577:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>h,tree:()=>c}),t(4123),t(8032),t(5866),t(6835);var a=t(3191),n=t(8716),r=t(7922),i=t.n(r),l=t(5231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(s,d);let c=["",{children:["(dashboard)",{children:["invoices",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,4123)),"E:\\frontend\\app\\(dashboard)\\invoices\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,8032)),"E:\\frontend\\app\\(dashboard)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,6835)),"E:\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],o=["E:\\frontend\\app\\(dashboard)\\invoices\\[id]\\page.tsx"],x="/(dashboard)/invoices/[id]/page",m={require:t,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/(dashboard)/invoices/[id]/page",pathname:"/invoices/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},5141:(e,s,t)=>{Promise.resolve().then(t.bind(t,2412))},2412:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>x});var a=t(326),n=t(7577),r=t(5047),i=t(6824),l=t(9052),d=t(2980),c=t(7698),o=t(2948);function x(){let{id:e}=(0,r.useParams)(),s=(0,r.useRouter)(),{showToast:t}=(0,o.p)(),[x,m]=(0,n.useState)(null),[h,u]=(0,n.useState)(!0),[p,j]=(0,n.useState)(!1),[f,y]=(0,n.useState)(null),[g,N]=(0,n.useState)({amount:"",paymentMethod:"CREDIT_CARD",reference:"",notes:""}),[b,v]=(0,n.useState)(!1),[C,w]=(0,n.useState)(!1),D=async()=>{try{let s=await i.g6.getOne(e);m(s)}catch(e){t(e.message||"Failed to load invoice","error")}finally{u(!1)}},P=async()=>{j(!0);try{await i.g6.confirm(e),t("Invoice confirmed","success"),y(null),D()}catch(e){t(e.message||"Failed to confirm invoice","error")}finally{j(!1)}},k=async()=>{j(!0);try{await i.g6.cancel(e),t("Invoice cancelled","success"),y(null),D()}catch(e){t(e.message||"Failed to cancel invoice","error")}finally{j(!1)}},A=async s=>{if(s.preventDefault(),!g.amount){t("Please enter an amount","error");return}v(!0);try{await i.iV.create({invoiceId:e,amount:parseFloat(g.amount),paymentMethod:g.paymentMethod,reference:g.reference||void 0,notes:g.notes||void 0}),t("Payment recorded","success"),N({amount:"",paymentMethod:"CREDIT_CARD",reference:"",notes:""}),D()}catch(e){t(e.message||"Failed to record payment","error")}finally{v(!1)}},F=async()=>{w(!0);try{let s=await i.tQ.generateInvoice(e);window.open(s.pdfUrl,"_blank"),t("PDF generated","success"),D()}catch(e){t(e.message||"Failed to generate PDF","error")}finally{w(!1)}};if(h)return a.jsx(d.Z,{message:"Loading invoice..."});if(!x)return(0,a.jsxs)("div",{className:"text-center py-12",children:[a.jsx("p",{className:"text-gray-500",children:"Invoice not found."}),a.jsx("button",{onClick:()=>s.back(),className:"btn-secondary mt-4",children:"Go Back"})]});let E=x.lines?.reduce((e,s)=>e+Number(s.unitPrice)*Number(s.quantity)-Number(s.discount||0),0)||0,I=x.lines?.reduce((e,s)=>e+Number(s.taxAmount||0),0)||0,R=Number(x.totalAmount)||0,T=Number(x.paidAmount)||0,_=R-T,S=x.dueDate&&new Date(x.dueDate)<new Date&&_>0&&"CANCELLED"!==x.status&&"PAID"!==x.status,L={CREDIT_CARD:"Credit Card",DEBIT_CARD:"Debit Card",BANK_TRANSFER:"Bank Transfer",UPI:"UPI",CASH:"Cash",OTHER:"Other"};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("button",{onClick:()=>s.back(),className:"btn-secondary btn-sm",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),(0,a.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:["Invoice ",x.invoiceNumber]}),a.jsx(l.Z,{status:x.status}),S&&a.jsx("span",{className:"badge bg-red-100 text-red-700",children:"OVERDUE"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:F,disabled:C,className:"btn-secondary",children:[a.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),C?"Generating...":"Download PDF"]}),"DRAFT"===x.status&&(0,a.jsxs)(a.Fragment,{children:[a.jsx("button",{onClick:()=>y("confirm"),className:"btn-primary",disabled:p,children:"Confirm Invoice"}),a.jsx("button",{onClick:()=>y("cancel"),className:"btn-danger",disabled:p,children:"Cancel"})]}),"CONFIRMED"===x.status&&a.jsx("button",{onClick:()=>y("cancel"),className:"btn-danger",disabled:p,children:"Cancel Invoice"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{className:"card p-5",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase mb-3",children:"Invoice Details"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Number"}),a.jsx("span",{className:"font-mono font-medium",children:x.invoiceNumber})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Date"}),a.jsx("span",{children:new Date(x.invoiceDate).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Due Date"}),a.jsx("span",{className:S?"text-red-600 font-medium":"",children:x.dueDate?new Date(x.dueDate).toLocaleDateString():"-"})]}),x.subscription&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Subscription"}),a.jsx("span",{className:"font-mono text-xs",children:x.subscription.subscriptionNumber})]})]})]}),(0,a.jsxs)("div",{className:"card p-5",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase mb-3",children:"Customer"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Name"}),a.jsx("span",{className:"font-medium",children:x.customer?.name||"-"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Email"}),a.jsx("span",{children:x.customer?.email||"-"})]}),x.contact&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Contact"}),a.jsx("span",{children:x.contact.name})]})]})]}),(0,a.jsxs)("div",{className:"card p-5",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase mb-3",children:"Amounts"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Subtotal"}),(0,a.jsxs)("span",{children:["₹",E.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-500",children:"Tax"}),(0,a.jsxs)("span",{children:["₹",I.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between font-semibold border-t pt-2",children:[a.jsx("span",{children:"Total"}),(0,a.jsxs)("span",{children:["₹",R.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-emerald-600",children:[a.jsx("span",{children:"Paid"}),(0,a.jsxs)("span",{children:["₹",T.toFixed(2)]})]}),(0,a.jsxs)("div",{className:`flex justify-between font-bold border-t pt-2 ${_>0?"text-red-600":"text-emerald-600"}`,children:[a.jsx("span",{children:"Balance Due"}),(0,a.jsxs)("span",{children:["₹",_.toFixed(2)]})]})]})]})]}),x.notes&&(0,a.jsxs)("div",{className:"card p-5",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase mb-2",children:"Notes"}),a.jsx("p",{className:"text-sm text-gray-700",children:x.notes})]}),(0,a.jsxs)("div",{className:"card p-5",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Line Items"}),a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"text-left px-4 py-2.5 font-medium text-gray-600",children:"Product"}),a.jsx("th",{className:"text-left px-4 py-2.5 font-medium text-gray-600",children:"Description"}),a.jsx("th",{className:"text-right px-4 py-2.5 font-medium text-gray-600",children:"Qty"}),a.jsx("th",{className:"text-right px-4 py-2.5 font-medium text-gray-600",children:"Unit Price"}),a.jsx("th",{className:"text-right px-4 py-2.5 font-medium text-gray-600",children:"Discount"}),a.jsx("th",{className:"text-right px-4 py-2.5 font-medium text-gray-600",children:"Tax"}),a.jsx("th",{className:"text-right px-4 py-2.5 font-medium text-gray-600",children:"Amount"})]})}),(0,a.jsxs)("tbody",{children:[x.lines?.map(e=>a.jsxs("tr",{className:"border-t border-gray-100",children:[a.jsx("td",{className:"px-4 py-2.5 font-medium text-gray-900",children:e.product?.name||"-"}),a.jsx("td",{className:"px-4 py-2.5 text-gray-500",children:e.description||"-"}),a.jsx("td",{className:"px-4 py-2.5 text-right",children:e.quantity}),a.jsxs("td",{className:"px-4 py-2.5 text-right",children:["₹",Number(e.unitPrice).toFixed(2)]}),a.jsx("td",{className:"px-4 py-2.5 text-right",children:e.discount>0?`₹${Number(e.discount).toFixed(2)}`:"-"}),a.jsxs("td",{className:"px-4 py-2.5 text-right",children:[e.tax?`${e.tax.name} (${e.tax.rate}%)`:"-",e.taxAmount>0&&a.jsxs("span",{className:"block text-xs text-gray-400",children:["₹",Number(e.taxAmount).toFixed(2)]})]}),a.jsxs("td",{className:"px-4 py-2.5 text-right font-medium",children:["₹",Number(e.amount).toFixed(2)]})]},e.id)),(!x.lines||0===x.lines.length)&&a.jsx("tr",{children:a.jsx("td",{colSpan:7,className:"px-4 py-6 text-center text-gray-500",children:"No line items."})})]})]})}),a.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 flex justify-end",children:(0,a.jsxs)("div",{className:"w-72 space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Subtotal"}),(0,a.jsxs)("span",{className:"font-medium",children:["₹",E.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{className:"text-gray-500",children:"Tax"}),(0,a.jsxs)("span",{className:"font-medium",children:["₹",I.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm font-semibold border-t pt-2",children:[a.jsx("span",{children:"Total"}),(0,a.jsxs)("span",{children:["₹",R.toFixed(2)]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-emerald-600",children:[a.jsx("span",{children:"Paid"}),(0,a.jsxs)("span",{className:"font-medium",children:["₹",T.toFixed(2)]})]}),(0,a.jsxs)("div",{className:`flex justify-between text-base font-bold border-t pt-2 ${_>0?"text-red-600":"text-emerald-600"}`,children:[a.jsx("span",{children:"Balance Due"}),(0,a.jsxs)("span",{children:["₹",_.toFixed(2)]})]})]})})]}),x.payments&&x.payments.length>0&&(0,a.jsxs)("div",{className:"card p-5",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Payment History"}),a.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:(0,a.jsxs)("table",{className:"w-full text-sm",children:[a.jsx("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[a.jsx("th",{className:"text-left px-4 py-2.5 font-medium text-gray-600",children:"Date"}),a.jsx("th",{className:"text-left px-4 py-2.5 font-medium text-gray-600",children:"Method"}),a.jsx("th",{className:"text-left px-4 py-2.5 font-medium text-gray-600",children:"Reference"}),a.jsx("th",{className:"text-right px-4 py-2.5 font-medium text-gray-600",children:"Amount"}),a.jsx("th",{className:"text-left px-4 py-2.5 font-medium text-gray-600",children:"Notes"})]})}),a.jsx("tbody",{children:x.payments.map(e=>(0,a.jsxs)("tr",{className:"border-t border-gray-100",children:[a.jsx("td",{className:"px-4 py-2.5",children:new Date(e.paymentDate).toLocaleDateString()}),a.jsx("td",{className:"px-4 py-2.5",children:L[e.paymentMethod]||e.paymentMethod}),a.jsx("td",{className:"px-4 py-2.5 font-mono text-xs",children:e.reference||"-"}),(0,a.jsxs)("td",{className:"px-4 py-2.5 text-right font-semibold text-emerald-600",children:["₹",Number(e.amount).toFixed(2)]}),a.jsx("td",{className:"px-4 py-2.5 text-gray-500",children:e.notes||"-"})]},e.id))})]})})]}),"CONFIRMED"===x.status&&_>0&&(0,a.jsxs)("div",{className:"card p-5",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Record Payment"}),(0,a.jsxs)("form",{onSubmit:A,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"form-label",children:"Amount *"}),a.jsx("input",{type:"number",step:"0.01",max:_,value:g.amount,onChange:e=>N({...g,amount:e.target.value}),className:"form-input",placeholder:_.toFixed(2),required:!0})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"form-label",children:"Payment Method"}),(0,a.jsxs)("select",{value:g.paymentMethod,onChange:e=>N({...g,paymentMethod:e.target.value}),className:"form-select",children:[a.jsx("option",{value:"CREDIT_CARD",children:"Credit Card"}),a.jsx("option",{value:"DEBIT_CARD",children:"Debit Card"}),a.jsx("option",{value:"BANK_TRANSFER",children:"Bank Transfer"}),a.jsx("option",{value:"UPI",children:"UPI"}),a.jsx("option",{value:"CASH",children:"Cash"}),a.jsx("option",{value:"OTHER",children:"Other"})]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"form-label",children:"Reference"}),a.jsx("input",{type:"text",value:g.reference,onChange:e=>N({...g,reference:e.target.value}),className:"form-input",placeholder:"Transaction ref (optional)"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"form-label",children:"Notes"}),a.jsx("input",{type:"text",value:g.notes,onChange:e=>N({...g,notes:e.target.value}),className:"form-input",placeholder:"Notes (optional)"})]})]}),a.jsx("button",{type:"submit",disabled:b,className:"btn-primary",children:b?"Recording...":"Record Payment"})]})]}),a.jsx(c.Z,{isOpen:"confirm"===f,onConfirm:P,onCancel:()=>y(null),title:"Confirm Invoice",message:"Confirm this invoice? It will be marked as ready for payment.",confirmLabel:"Confirm",variant:"warning",loading:p}),a.jsx(c.Z,{isOpen:"cancel"===f,onConfirm:k,onCancel:()=>y(null),title:"Cancel Invoice",message:"Cancel this invoice? This cannot be undone.",confirmLabel:"Cancel Invoice",variant:"danger",loading:p})]})}},7698:(e,s,t)=>{"use strict";t.d(s,{Z:()=>n});var a=t(326);function n({isOpen:e,onConfirm:s,onCancel:t,title:n,message:r,confirmLabel:i="Confirm",variant:l="danger",loading:d=!1}){return e?(0,a.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[a.jsx("div",{className:"fixed inset-0 bg-black/40",onClick:t}),(0,a.jsxs)("div",{className:"relative bg-white rounded-lg shadow-xl w-full max-w-sm mx-4 p-6",children:[(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${"danger"===l?"bg-red-100":"bg-yellow-100"}`,children:a.jsx("svg",{className:`w-5 h-5 ${"danger"===l?"text-red-600":"text-yellow-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,a.jsxs)("div",{className:"flex-1",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:n}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[a.jsx("button",{onClick:t,className:"btn-secondary",children:"Cancel"}),a.jsx("button",{onClick:s,disabled:d,className:"danger"===l?"btn-danger":"btn-primary",children:d?"Processing...":i})]})]})]}):null}},9052:(e,s,t)=>{"use strict";t.d(s,{Z:()=>r});var a=t(326);let n={DRAFT:"badge-draft",QUOTATION:"badge-quotation",CONFIRMED:"badge-confirmed",ACTIVE:"badge-active",PAID:"badge-paid",CLOSED:"badge-closed",CANCELLED:"badge-cancelled"};function r({status:e}){let s=n[e]||"badge-draft";return a.jsx("span",{className:s,children:e.replace("_"," ")})}},4123:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(8570).createProxy)(String.raw`E:\frontend\app\(dashboard)\invoices\[id]\page.tsx#default`)}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[697,496,315,78],()=>t(6577));module.exports=a})();